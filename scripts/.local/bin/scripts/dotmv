#!/bin/sh

curdir=$(pwd)
# package name from second
pkg=$1

# Strip the /home/$USER part
dir=$(dirname "$(realpath "$2")" | sed "s|^$HOME/||")
# echo $dir

# Make dotfiles dir
dotdir=$HOME/dotfiles/$pkg/$dir
mkdir -p $dotdir
echo
echo "moving: "

for ((i = 2; i <= $#; i++)); do
    arg="${!i}"
    filepath=$(realpath "${!i}")
    relpath="${filepath/#${HOME}\//}"
    echo $relpath
    mv $filepath $dotdir
done

echo
echo "to: ~/dotfiles/"$pkg
cd $HOME/dotfiles
stow $pkg
cd $curdir
